<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" th:replace="~{layout :: layout}">
  <div th:fragment="content">
    <h2>Lotes</h2>

    <form class="form-inline mb-2" method="get" th:action="@{/lotes}">
        <div class="form-group mr-2">
            <label class="mr-2">Fiscalizador</label>
            <select class="form-control" name="idFiscalizador">
                <option value="">-- Todos --</option>
                <option th:each="f : ${fiscalizadores}" th:value="${f.id}" th:text="${f.nome}"></option>
            </select>
        </div>
        <div class="form-group mr-2">
            <label class="mr-2">Donatário</label>
            <select class="form-control" name="idDonatario">
                <option value="">-- Todos --</option>
                <option th:each="d : ${donatarios}" th:value="${d.id}" th:text="${d.nome}"></option>
            </select>
        </div>
        <button class="btn btn-primary" type="submit">Filtrar</button>
        <a class="btn btn-link" th:href="@{/lotes}">Limpar</a>
    </form>

    <a class="btn btn-primary mb-2" th:href="@{/lotes/novo}">Novo Lote</a>
    <table class="table table-striped">
        <thead><tr><th>ID</th><th>Data</th><th>Fiscalizador</th><th>Donatário</th><th>Produtos</th><th>Ações</th></tr></thead>
        <tbody>
        <tr th:each="l : ${lista}">
            <td th:text="${l.id}">1</td>
            <td th:text="${l.dataEntrega}">2025-01-01</td>
            <td th:text="${l.nomeOrgaoFiscalizador}">Fiscalizador</td>
<td th:text="${l.nomeOrgaoDonatario}">Donatário</td>

            <td>
                <ul>
                    <li th:each="p : ${l.produtos}" 
    th:text="|${p.nome} (${p.codigoBarras})|"> Produto </li>

                </ul>
                
            </td>
            <td>
                <a th:href="@{|/lotes/editar/${l.id}|}" class="btn btn-sm btn-info">Editar</a>
                <a th:href="@{|/lotes/deletar/${l.id}|}" class="btn btn-sm btn-danger">Excluir</a>
            </td>
        </tr>
        </tbody>
    </table>
</div>
</html>
